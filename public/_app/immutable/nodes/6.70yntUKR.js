import"../chunks/CWj6FrbW.js";import{i as we}from"../chunks/CCVlYhmH.js";import{o as ke}from"../chunks/CxfMjxZB.js";import{p as De,b as v,t as g,a as p,d as Le,e as t,n as C,r as s,s as i,g as e,m as c,h as o,c as Se,f as Y,i as J,j as Ce,k as Ee,l as qe,o as ze}from"../chunks/DywqVBIy.js";import{i as E}from"../chunks/ASrwIIbz.js";import{s as Z,r as P,e as Ae,i as Ie,b as Me}from"../chunks/y8QnOz8S.js";import{b as F,a as Te}from"../chunks/BUqQ10_7.js";import{p as je}from"../chunks/CWmzcjye.js";import{a as $e,b as Be}from"../chunks/Y82m_CnN.js";import{A as Je,p as Pe}from"../chunks/DTpbi_VQ.js";import{g as Fe}from"../chunks/DfZmdmjZ.js";import{s as ee}from"../chunks/BHeDoN2z.js";import{L as ae}from"../chunks/CsbSaeic.js";var Ge=v('<div class="text-center py-12"><!> <p class="text-gray-600">Loading dream...</p></div>'),He=v('<div class="text-red-500 text-center py-12"> </div>'),Ke=v("<option> </option>"),Ne=v('<div class="text-red-500 text-sm"> </div>'),Oe=v("<!> Saving Changes...",1),Qe=v('<div class="bg-white rounded-lg shadow-md p-6"><h1 class="text-2xl font-bold text-purple-900 mb-6">Edit Dream</h1> <form class="space-y-6"><div><label for="title" class="block text-sm font-medium text-gray-700">Dream Title</label> <input type="text" id="title" required class="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 focus:border-purple-500 focus:ring-purple-500"/></div> <div><label for="description" class="block text-sm font-medium text-gray-700">Description</label> <textarea id="description" required rows="4" class="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 focus:border-purple-500 focus:ring-purple-500"></textarea></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><label for="mood" class="block text-sm font-medium text-gray-700">Mood</label> <select id="mood" class="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 focus:border-purple-500 focus:ring-purple-500"><option>Select mood...</option><!></select></div> <div><label for="tags" class="block text-sm font-medium text-gray-700">Tags</label> <input type="text" id="tags" class="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 focus:border-purple-500 focus:ring-purple-500" placeholder="flying, water, chase (comma separated)"/></div></div> <div class="flex items-center"><input type="checkbox" id="isLucid" class="h-4 w-4 text-purple-600 rounded focus:ring-purple-500"/> <label for="isLucid" class="ml-2 block text-sm text-gray-700">This was a lucid dream (I knew I was dreaming)</label></div> <!> <div class="flex gap-4"><button type="submit" class="flex-1 bg-purple-600 text-white py-2 px-4 rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 disabled:opacity-50"><!></button> <a class="flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 text-center">Cancel</a></div></form></div>'),Re=v('<div class="max-w-2xl mx-auto px-4 py-8"><a class="inline-flex items-center text-purple-600 hover:text-purple-700 mb-6"><!> Back to Dream</a> <!></div>');function la(re,te){De(te,!1);const[se,oe]=$e(),G=()=>Be(Pe,"$page",se);let y=c(null),H=c(!0),h=c(!1),m=c(""),w=c(""),k=c(""),_=c(""),D=c(!1),b=c("");const ie=["Peaceful","Anxious","Exciting","Mysterious","Scary","Joyful","Confusing"];async function le(){try{const{data:a,error:l}=await ee.from("dreams").select("*").eq("id",G().params.id).single();if(l)throw l;if(!a)throw new Error("Dream not found");o(y,a),o(w,a.title),o(k,a.description),o(_,a.mood||""),o(D,a.is_lucid),o(b,a.tags?a.tags.join(", "):"")}catch(a){o(m,a.message)}finally{o(H,!1)}}async function de(){o(h,!0),o(m,"");try{const{error:a}=await ee.from("dreams").update({title:e(w),description:e(k),mood:e(_).toLowerCase(),is_lucid:e(D),tags:e(b)?e(b).split(",").map(l=>l.trim()):[],updated_at:new Date().toISOString()}).eq("id",e(y).id);if(a)throw a;Fe(`/dreams/${e(y).id}`)}catch(a){o(m,a.message),o(h,!1)}}ke(()=>{le()}),we();var q=Re(),L=t(q),ne=t(L);Je(ne,{size:20,class:"mr-2"}),C(),s(L);var pe=i(L,2);{var ce=a=>{var l=Ge(),z=t(l);ae(z,{class:"mx-auto text-purple-600 animate-spin mb-4",size:48}),C(2),s(l),p(a,l)},me=a=>{var l=Se(),z=Y(l);{var ue=f=>{var u=He(),x=t(u,!0);s(u),g(()=>J(x,e(m))),p(f,u)},ve=f=>{var u=Qe(),x=i(t(u),2),A=t(x),K=i(t(A),2);P(K),s(A);var I=i(A,2),N=i(t(I),2);Ce(N),s(I);var M=i(I,2),T=t(M),j=i(t(T),2);g(()=>{e(_),Ee(()=>{})});var $=t(j);$.value=$.__value="";var fe=i($);Ae(fe,1,()=>ie,Ie,(r,d)=>{var n=Ke(),he=t(n,!0);s(n);var W={};g(X=>{J(he,e(d)),W!==(W=X)&&(n.value=(n.__value=X)??"")},[()=>e(d).toLowerCase()]),p(r,n)}),s(j),s(T);var O=i(T,2),Q=i(t(O),2);P(Q),s(O),s(M);var B=i(M,2),R=t(B);P(R),C(2),s(B);var U=i(B,2);{var ge=r=>{var d=Ne(),n=t(d,!0);s(d),g(()=>J(n,e(m))),p(r,d)};E(U,r=>{e(m)&&r(ge)})}var V=i(U,2),S=t(V),_e=t(S);{var be=r=>{var d=Oe(),n=Y(d);ae(n,{class:"inline animate-spin mr-2",size:20}),C(),p(r,d)},xe=r=>{var d=ze("Save Changes");p(r,d)};E(_e,r=>{e(h)?r(be):r(xe,!1)})}s(S);var ye=i(S,2);s(V),s(x),s(u),g(()=>{S.disabled=e(h),Z(ye,"href",`/dreams/${e(y).id??""}`)}),F(K,()=>e(w),r=>o(w,r)),F(N,()=>e(k),r=>o(k,r)),Me(j,()=>e(_),r=>o(_,r)),F(Q,()=>e(b),r=>o(b,r)),Te(R,()=>e(D),r=>o(D,r)),qe("submit",x,je(de)),p(f,u)};E(z,f=>{e(m)?f(ue):f(ve,!1)},!0)}p(a,l)};E(pe,a=>{e(H)?a(ce):a(me,!1)})}s(q),g(()=>Z(L,"href",`/dreams/${G().params.id??""}`)),p(re,q),Le(),oe()}export{la as component};
