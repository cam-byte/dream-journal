import"../chunks/CWj6FrbW.js";import{i as ce}from"../chunks/CCVlYhmH.js";import{c as ue,f as w,a as u,p as me,b as v,t as E,l as O,d as ve,h as c,m as y,g as s,i as I,e as a,s as i,r as t,n as _,P as fe,Q as ge}from"../chunks/DywqVBIy.js";import{i as C}from"../chunks/ASrwIIbz.js";import{r as K,c as _e,a as be}from"../chunks/y8QnOz8S.js";import{b as he}from"../chunks/BUqQ10_7.js";import{p as xe}from"../chunks/CWmzcjye.js";import{s as b}from"../chunks/BHeDoN2z.js";import{g as H}from"../chunks/CBVvHBor.js";import{L as T}from"../chunks/CsbSaeic.js";import{U as ye}from"../chunks/SeQP5rXR.js";import{M as we}from"../chunks/BT2HKzp0.js";import{I as Se,s as De}from"../chunks/B2UO5zuC.js";import{l as Le,s as Pe}from"../chunks/Y82m_CnN.js";function $e(S,h){const n=Le(h,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];Se(S,Pe({name:"save"},()=>n,{get iconNode(){return x},children:(m,p)=>{var f=ue(),D=w(f);De(D,h,"default",{}),u(m,f)},$$slots:{default:!0}}))}var ke=v('<div class="p-6 text-center text-gray-500"><!> Loading profile...</div>'),Me=v("<div> </div>"),Ne=v("<!> Saving...",1),Ue=v("<!> Save Changes",1),ze=v('<form class="p-6 space-y-6"><!> <div class="space-y-2"><label for="name" class="block font-medium text-gray-700 flex items-center gap-2"><!> Name</label> <input type="text" id="name" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="Enter your name"/></div> <div class="space-y-2"><label for="email" class="block font-medium text-gray-700 flex items-center gap-2"><!> Email</label> <input type="email" id="email" readonly="" class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md shadow-sm text-gray-500"/></div> <button type="submit" class="w-full flex items-center justify-center gap-2 py-2 px-4 border border-transparent rounded-md shadow-sm text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:bg-purple-400 disabled:cursor-not-allowed transition-colors"><!></button></form> <div class="border-t p-6"><h2 class="text-lg font-medium mb-4">Account Actions</h2> <button class="text-blue-600 hover:text-blue-500 hover:underline">Reset Password</button></div>',1),Ae=v('<div class="container mx-auto px-4 py-8 max-w-2xl !mt-8"><div class="bg-white rounded-lg shadow-sm border"><div class="p-6 border-b"><h1 class="text-2xl font-bold">Profile Settings</h1></div> <!></div> <div class="mt-8 bg-white rounded-lg shadow-sm border p-6"><h2 class="text-lg font-medium mb-4">Account Statistics</h2> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><p class="text-gray-600">Member Since</p> <p class="text-lg font-medium"> </p></div> <div><p class="text-gray-600">Last Updated</p> <p class="text-lg font-medium"> </p></div></div></div> <div class="mt-8 text-center"><button class="text-red-600 hover:text-red-500 hover:underline">Sign Out</button></div></div>');function Ke(S,h){me(h,!1);let n=y({name:"",email:"",created_at:null,updated_at:null}),x=y(!0),m=y(!1),p=y({text:"",type:""});async function f(){try{const{data:{user:e}}=await b.auth.getUser();if(!e){await H("/auth/login");return}const{data:r,error:d}=await b.from("user_profiles").select("name, email, updated_at").eq("id",e.id).maybeSingle();if(d)throw d;c(n,{name:(r==null?void 0:r.name)||"",email:e.email||"",created_at:e.created_at,updated_at:(r==null?void 0:r.updated_at)||null})}catch(e){console.error("Load error:",e),c(p,{text:e.message||"Error loading profile",type:"error"})}finally{c(x,!1)}}async function D(){try{await b.auth.signOut(),H("/auth/login")}catch(e){console.error("Sign out error:",e)}}async function W(){try{c(m,!0),c(p,{text:"",type:""});const{data:{user:e}}=await b.auth.getUser();if(!e)throw new Error("No user found");const r={id:e.id,name:s(n).name,updated_at:new Date().toISOString()},{error:d}=await b.from("user_profiles").upsert(r,{onConflict:"id",returning:"minimal"});if(d)throw d;c(p,{text:"Profile updated successfully!",type:"success"}),await f()}catch(e){console.error("Update error:",e),c(p,{text:e.message||"Failed to update profile",type:"error"})}finally{c(m,!1)}}f(),ce();var L=Ae(),P=a(L),X=i(a(P),2);{var Y=e=>{var r=ke(),d=a(r);T(d,{class:"animate-spin inline-block"}),_(),t(r),u(e,r)},Z=e=>{var r=ze(),d=w(r),R=a(d);{var re=o=>{var l=Me(),g=a(l,!0);t(l),E(()=>{be(l,1,`p-4 rounded-md ${s(p).type==="error"?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`),I(g,s(p).text)}),u(o,l)};C(R,o=>{s(p).text&&o(re)})}var M=i(R,2),N=a(M),se=a(N);ye(se,{size:20}),_(),t(N);var B=i(N,2);K(B),t(M);var U=i(M,2),z=a(U),oe=a(z);we(oe,{size:20}),_(),t(z);var G=i(z,2);K(G),t(U);var A=i(U,2),ie=a(A);{var le=o=>{var l=Ne(),g=w(l);T(g,{class:"animate-spin"}),_(),u(o,l)},ne=o=>{var l=Ue(),g=w(l);$e(g,{size:20}),_(),u(o,l)};C(ie,o=>{s(m)?o(le):o(ne,!1)})}t(A),t(d);var J=i(d,2),de=i(a(J),2),pe=ge(()=>H("/auth/reset-password"));t(J),E(()=>{_e(G,s(n).email),A.disabled=s(m)}),he(B,()=>s(n).name,o=>fe(n,s(n).name=o)),O("submit",d,xe(W)),O("click",de,function(...o){var l;(l=s(pe))==null||l.apply(this,o)}),u(e,r)};C(X,e=>{s(x)?e(Y):e(Z,!1)})}t(P);var $=i(P,2),V=i(a($),2),k=a(V),j=i(a(k),2),ee=a(j,!0);t(j),t(k);var q=i(k,2),F=i(a(q),2),ae=a(F,!0);t(F),t(q),t(V),t($);var Q=i($,2),te=a(Q);t(Q),t(L),E((e,r)=>{I(ee,e),I(ae,r)},[()=>s(n).created_at?new Date(s(n).created_at).toLocaleDateString():"N/A",()=>s(n).updated_at?new Date(s(n).updated_at).toLocaleDateString():"N/A"]),O("click",te,D),u(S,L),ve()}export{Ke as component};
