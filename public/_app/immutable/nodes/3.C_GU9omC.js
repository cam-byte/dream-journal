import"../chunks/CWj6FrbW.js";import{i as tt}from"../chunks/CCVlYhmH.js";import{c as V,f as j,a as i,p as et,b as c,t as $,l as rt,d as st,h as P,m as R,e as t,s as r,n as y,r as a,g as e,i as p}from"../chunks/DywqVBIy.js";import{i as w}from"../chunks/ASrwIIbz.js";import{e as fa,s as ha,i as xa}from"../chunks/y8QnOz8S.js";import{b as ot,r as it}from"../chunks/T6-usF2s.js";import{s as sa}from"../chunks/BHeDoN2z.js";import{g as lt}from"../chunks/DfZmdmjZ.js";import{C as dt,B as ba}from"../chunks/Ct_S6QVg.js";import{I as wa,s as Da}from"../chunks/B2UO5zuC.js";import{l as Ma,s as $a}from"../chunks/Y82m_CnN.js";import{C as nt}from"../chunks/CYZG1vBQ.js";import{M as vt}from"../chunks/FLBswei7.js";function ct(C,f){const D=Ma(f,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}],["polyline",{points:"16 17 21 12 16 7"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12"}]];wa(C,$a({name:"log-out"},()=>D,{get iconNode(){return h},children:(g,x)=>{var u=V(),N=j(u);Da(N,f,"default",{}),i(g,u)},$$slots:{default:!0}}))}function ya(C,f){const D=Ma(f,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"}]];wa(C,$a({name:"star"},()=>D,{get iconNode(){return h},children:(g,x)=>{var u=V(),N=j(u);Da(N,f,"default",{}),i(g,u)},$$slots:{default:!0}}))}var mt=c('<div class="p-6 text-center text-gray-500">Loading...</div>'),pt=c('<div class="p-6 text-center text-red-500"> </div>'),gt=c('<div class="p-6 text-center text-gray-500">No dreams recorded yet. <a href="/dreams/new" class="text-purple-600 hover:underline">Record your first dream</a></div>'),ut=c('<img alt="Dream visualization" class="w-20 h-20 object-cover rounded"/>'),_t=c('<span class="text-purple-600 capitalize"> </span>'),ft=c('<span class="text-blue-600">Lucid</span>'),ht=c('<span class="px-2 py-1 bg-gray-100 rounded-full text-xs text-gray-600"> </span>'),xt=c('<div class="mt-2 flex gap-2 flex-wrap"></div>'),bt=c('<a class="block p-6 hover:bg-gray-50 transition-colors"><div class="flex gap-4"><!> <div class="flex-1"><h3 class="font-medium mb-2"> </h3> <p class="text-gray-600 text-sm line-clamp-2"> </p> <div class="mt-2 flex gap-4 text-sm"><span class="text-gray-500"> </span> <!> <!></div> <!></div></div></a>'),yt=c('<div class="divide-y"></div>'),wt=c('<div class="p-4 border-t"><a href="/dreams" class="text-purple-600 hover:underline text-sm">View all dreams â†’</a></div>'),Dt=c('<div class="container mx-auto px-4 py-8 !mt-8"><h1 class="text-3xl font-bold mb-8">Dream Journal Dashboard</h1> <div class="mb-8"><h2 class="text-xl font-semibold mb-4">Quick Actions</h2> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"><a href="/dreams/new" class="flex items-center gap-3 p-4 bg-purple-100 rounded-lg hover:bg-purple-200 transition-colors"><!> <span class="font-medium">Record New Dream</span></a> <a href="/dreams" class="flex items-center gap-3 p-4 bg-blue-100 rounded-lg hover:bg-blue-200 transition-colors"><!> <span class="font-medium">View Dream Journal</span></a> <a href="/profile" class="flex items-center gap-3 p-4 bg-green-100 rounded-lg hover:bg-green-200 transition-colors"><!> <span class="font-medium">Profile Settings</span></a> <button class="flex items-center gap-3 p-4 bg-red-100 rounded-lg hover:bg-red-200 transition-colors"><!> <span class="font-medium">Sign Out</span></button></div></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"><div class="bg-white p-6 rounded-lg shadow-sm border"><div class="flex items-center gap-3 mb-3"><!> <h3 class="font-medium text-gray-600">Total Dreams</h3></div> <p class="text-3xl font-bold"> </p></div> <div class="bg-white p-6 rounded-lg shadow-sm border"><div class="flex items-center gap-3 mb-3"><!> <h3 class="font-medium text-gray-600">This Month</h3></div> <p class="text-3xl font-bold"> </p></div> <div class="bg-white p-6 rounded-lg shadow-sm border"><div class="flex items-center gap-3 mb-3"><!> <h3 class="font-medium text-gray-600">Lucid Dreams</h3></div> <p class="text-3xl font-bold"> </p></div> <div class="bg-white p-6 rounded-lg shadow-sm border"><div class="flex items-center gap-3 mb-3"><!> <h3 class="font-medium text-gray-600">Common Mood</h3></div> <p class="text-3xl font-bold capitalize"> </p></div></div> <div class="bg-white rounded-lg shadow-sm border"><div class="p-6 border-b"><h2 class="text-xl font-semibold">Recent Dreams</h2></div> <!> <!></div></div>');function Bt(C,f){et(f,!1);const D=async({parent:s})=>{const{session:l}=await s();if(!l)throw it(303,"/auth/login");return{session:l}};let h=R([]),g=R({totalDreams:0,thisMonth:0,lucidCount:0,mostCommonMood:""}),x=R(!0),u=R(null);async function N(){var s;try{const{data:l,error:z}=await sa.from("dreams").select(`
                    id,
                    title,
                    description,
                    created_at,
                    tags,
                    mood,
                    is_lucid,
                    image_url
                `).order("created_at",{ascending:!1}).limit(5);if(z)throw z;P(h,l);const{data:M,error:L}=await sa.from("dreams").select("created_at, mood, is_lucid");if(L)throw L;const _=new Date,b=new Date(_.getFullYear(),_.getMonth(),1),S=M.reduce((m,d)=>(d.mood&&(m[d.mood]=(m[d.mood]||0)+1),m),{}),W=((s=Object.entries(S).sort(([,m],[,d])=>d-m)[0])==null?void 0:s[0])||"None";P(g,{totalDreams:M.length,thisMonth:M.filter(m=>new Date(m.created_at)>=b).length,lucidCount:M.filter(m=>m.is_lucid).length,mostCommonMood:W})}catch(l){P(u,l.message)}finally{P(x,!1)}}async function Ca(){try{await sa.auth.signOut(),lt("/auth/login")}catch(s){console.error("Sign out error:",s)}}N(),tt();var B=Dt(),E=r(t(B),2),oa=r(t(E),2),I=t(oa),Na=t(I);dt(Na,{class:"text-purple-600"}),y(2),a(I);var J=r(I,2),Sa=t(J);ba(Sa,{class:"text-blue-600"}),y(2),a(J);var T=r(J,2),ka=t(T);ya(ka,{class:"text-green-600"}),y(2),a(T);var A=r(T,2),za=t(A);ct(za,{class:"text-red-600"}),y(2),a(A),a(oa),a(E);var F=r(E,2),H=t(F),Q=t(H),La=t(Q);ba(La,{class:"text-purple-600"}),y(2),a(Q);var ia=r(Q,2),Oa=t(ia,!0);a(ia),a(H);var Y=r(H,2),q=t(Y),Pa=t(q);nt(Pa,{class:"text-blue-600"}),y(2),a(q);var la=r(q,2),Ra=t(la,!0);a(la),a(Y);var G=r(Y,2),K=t(G),Va=t(K);vt(Va,{class:"text-green-600"}),y(2),a(K);var da=r(K,2),ja=t(da,!0);a(da),a(G);var na=r(G,2),U=t(na),Ba=t(U);ya(Ba,{class:"text-yellow-600"}),y(2),a(U);var va=r(U,2),Ea=t(va,!0);a(va),a(na),a(F);var ca=r(F,2),ma=r(t(ca),2);{var Ia=s=>{var l=mt();i(s,l)},Ja=s=>{var l=V(),z=j(l);{var M=_=>{var b=pt(),S=t(b,!0);a(b),$(()=>p(S,e(u))),i(_,b)},L=_=>{var b=V(),S=j(b);{var W=d=>{var k=gt();i(d,k)},m=d=>{var k=yt();fa(k,5,()=>e(h),xa,(Fa,n)=>{var O=bt(),pa=t(O),ga=t(pa);{var Ha=o=>{var v=ut();$(()=>ha(v,"src",e(n).image_url)),i(o,v)};w(ga,o=>{e(n).image_url&&o(Ha)})}var ua=r(ga,2),X=t(ua),Qa=t(X,!0);a(X);var Z=r(X,2),Ya=t(Z,!0);a(Z);var aa=r(Z,2),ta=t(aa),qa=t(ta,!0);a(ta);var _a=r(ta,2);{var Ga=o=>{var v=_t(),ea=t(v,!0);a(v),$(()=>p(ea,e(n).mood)),i(o,v)};w(_a,o=>{e(n).mood&&o(Ga)})}var Ka=r(_a,2);{var Ua=o=>{var v=ft();i(o,v)};w(Ka,o=>{e(n).is_lucid&&o(Ua)})}a(aa);var Wa=r(aa,2);{var Xa=o=>{var v=xt();fa(v,5,()=>e(n).tags,xa,(ea,Za)=>{var ra=ht(),at=t(ra,!0);a(ra),$(()=>p(at,e(Za))),i(ea,ra)}),a(v),i(o,v)};w(Wa,o=>{e(n).tags&&e(n).tags.length>0&&o(Xa)})}a(ua),a(pa),a(O),$(o=>{ha(O,"href",`/dreams/${e(n).id??""}`),p(Qa,e(n).title),p(Ya,e(n).description),p(qa,o)},[()=>new Date(e(n).created_at).toLocaleDateString()]),i(Fa,O)}),a(k),i(d,k)};w(S,d=>{e(h).length===0?d(W):d(m,!1)},!0)}i(_,b)};w(z,_=>{e(u)?_(M):_(L,!1)},!0)}i(s,l)};w(ma,s=>{e(x)?s(Ia):s(Ja,!1)})}var Ta=r(ma,2);{var Aa=s=>{var l=wt();i(s,l)};w(Ta,s=>{e(h).length>0&&s(Aa)})}return a(ca),a(B),$(()=>{p(Oa,e(x)?"...":e(g).totalDreams),p(Ra,e(x)?"...":e(g).thisMonth),p(ja,e(x)?"...":e(g).lucidCount),p(Ea,e(x)?"...":e(g).mostCommonMood)}),rt("click",A,Ca),i(C,B),ot(f,"load",D),st({load:D})}export{Bt as component};
